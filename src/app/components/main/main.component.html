<div
  class="container"
  [ngStyle]="{ 'background-color': theme.backgroundColor }"
>
  <!-- √úst Navigasyon Men√ºs√º -->
  <nav class="top-nav" [ngStyle]="{ 'background-color': theme.headerColor }">
    <div class="header-title" [ngStyle]="{ color: theme.accentColor }">
      AutoConnect
    </div>

    <div class="nav-items">
      <div
        class="nav-item"
        [class.active]="activeTab === 'AnaSayfa'"
        (click)="changeTab('AnaSayfa')"
      >
        <span class="nav-icon">üè†</span>
        <span class="nav-text">Ana Sayfa</span>
      </div>
      <div
        class="nav-item"
        [class.active]="activeTab === 'Sat'"
        (click)="changeTab('Sat')"
      >
        <span class="nav-icon">üí∞</span>
        <span class="nav-text">Sat</span>
      </div>
      <div
        class="nav-item"
        [class.active]="activeTab === 'Favoriler'"
        (click)="changeTab('Favoriler')"
      >
        <span class="nav-icon">‚ù§Ô∏è</span>
        <span class="nav-text">Favoriler</span>
      </div>
      <div
        class="nav-item"
        [class.active]="activeTab === 'Mesajlar'"
        (click)="changeTab('Mesajlar')"
      >
        <span class="nav-icon">üí¨</span>
        <span class="nav-text">Mesajlar</span>
        <span *ngIf="unreadMessageCount > 0" class="badge">{{
          unreadMessageCount
        }}</span>
      </div>
    </div>

    <div
      class="profile-button"
      [ngStyle]="{ 'background-color': theme.iconBackground }"
      (click)="handleProfilePress()"
    >
      <span class="profile-icon">üë§</span>
    </div>
  </nav>

  <!-- Ana ƒ∞√ßerik -->
  <div class="content-container">
    <!-- Sat Tab ƒ∞√ßeriƒüi -->
    <div *ngIf="activeTab === 'Sat'">
      <app-sell></app-sell>
    </div>

    <!-- Favoriler Tab ƒ∞√ßeriƒüi -->
    <div *ngIf="activeTab === 'Favoriler'">
      <app-favorites></app-favorites>
    </div>

    <!-- Mesajlar Tab ƒ∞√ßeriƒüi -->
    <div *ngIf="activeTab === 'Mesajlar'">
      <app-messages></app-messages>
    </div>

    <!-- Ana Sayfa ƒ∞√ßeriƒüi -->
    <div *ngIf="activeTab === 'AnaSayfa'">
      <!-- Arama Alanƒ± -->
      <div class="search-container">
        <div
          class="search-input-container"
          [ngStyle]="{
            'background-color': theme.cardColor,
            'border-color': theme.borderColor,
            'box-shadow': '0px 1px 2px ' + theme.shadowColor + '1A'
          }"
        >
          <span [ngStyle]="{ color: theme.secondaryTextColor }">üîç</span>
          <input
            type="text"
            class="search-input"
            [ngStyle]="{ color: theme.textColor }"
            placeholder="Marka, model veya konum ara..."
            [(ngModel)]="searchText"
            (input)="onSearchTextChange()"
          />
          <span
            *ngIf="searchText !== ''"
            (click)="searchText = ''; onSearchTextChange()"
            [ngStyle]="{ color: theme.secondaryTextColor }"
            class="clear-search"
            >‚úï</span
          >
        </div>
        <div
          class="filter-button"
          [ngStyle]="{ 'background-color': theme.buttonColor }"
        >
          <span class="filter-icon">‚öôÔ∏è</span>
        </div>
      </div>

      <!-- Arama Sonu√ßlarƒ± -->
      <div *ngIf="searchText.trim() !== ''" class="search-results-container">
        <h2 class="search-results-title" [ngStyle]="{ color: theme.textColor }">
          Arama Sonu√ßlarƒ±
        </h2>

        <div
          *ngFor="let car of searchResults"
          class="search-result-item"
          [ngStyle]="{
            'background-color': theme.cardColor,
            'box-shadow': '0px 1px 3px ' + theme.shadowColor + '3D'
          }"
          (click)="navigateToCarDetails(car)"
        >
          <img [src]="car.image" class="search-result-image" alt="Car Image" />
          <div class="search-result-details">
            <div
              class="search-result-title"
              [ngStyle]="{ color: theme.textColor }"
            >
              {{ car.year }} {{ car.make }} {{ car.model }}
            </div>
            <div
              class="search-result-price"
              [ngStyle]="{ color: theme.accentColor }"
            >
              {{ car.price }}
            </div>
            <div
              *ngIf="car.location"
              class="search-result-location"
              [ngStyle]="{ color: theme.secondaryTextColor }"
            >
              {{ car.location }}
            </div>
          </div>
          <div
            class="search-result-favorite-button"
            (click)="$event.stopPropagation(); toggleFavorite(car)"
          >
            <span class="favorite-icon">{{
              isFavorite(car.id) ? "‚ù§Ô∏è" : "ü§ç"
            }}</span>
          </div>
        </div>

        <div *ngIf="searchResults.length === 0" class="empty-results-container">
          <div
            class="empty-results-text"
            [ngStyle]="{ color: theme.textColor }"
          >
            "{{ searchText }}" i√ßin sonu√ß bulunamadƒ±
          </div>
        </div>
      </div>

      <!-- Ana Sayfa ƒ∞√ßeriƒüi (Arama yapƒ±lmadƒ±ƒüƒ±nda) -->
      <div *ngIf="searchText.trim() === ''" class="main-content">
        <!-- Kategoriler -->
        <div class="section-header">
          <div class="section-title" [ngStyle]="{ color: theme.textColor }">
            Kategoriler
          </div>
          <div
            *ngIf="selectedCategory"
            class="clear-filter-text"
            [ngStyle]="{ color: theme.accentColor }"
            (click)="clearFilter()"
          >
            Filtreyi Temizle
          </div>
        </div>

        <div class="categories-container">
          <div
            *ngFor="let category of categories"
            class="category-item"
            [class.selected]="selectedCategory === category.name"
            [ngStyle]="{
              'background-color':
                selectedCategory === category.name
                  ? theme.accentColor + '20'
                  : 'transparent'
            }"
            (click)="handleCategorySelect(category.name)"
          >
            <div class="category-icon">{{ category.icon }}</div>
            <div
              class="category-name"
              [ngStyle]="{
                color:
                  selectedCategory === category.name
                    ? theme.accentColor
                    : theme.textColor
              }"
            >
              {{ category.name }}
            </div>
          </div>
        </div>

        <!-- √ñne √áƒ±kan Ara√ßlar -->
        <div class="section-title" [ngStyle]="{ color: theme.textColor }">
          √ñne √áƒ±kan Ara√ßlar
        </div>
        <div class="featured-container">
          <div
            *ngFor="let car of featuredCars"
            class="featured-car-item"
            (click)="navigateToCarDetails(car)"
          >
            <img
              [src]="car.image"
              class="featured-car-image"
              alt="Featured Car"
            />
            <div
              class="featured-favorite-button"
              (click)="$event.stopPropagation(); toggleFavorite(car)"
            >
              <span class="favorite-icon">{{
                isFavorite(car.id) ? "‚ù§Ô∏è" : "ü§ç"
              }}</span>
            </div>
            <div class="featured-car-overlay">
              <div class="featured-car-title">
                {{ car.year }} {{ car.make }} {{ car.model }}
              </div>
              <div class="featured-car-price">{{ car.price }}</div>
            </div>
          </div>
        </div>

        <!-- Ara√ß Listesi -->
        <div class="list-header-container">
          <div class="section-title" [ngStyle]="{ color: theme.textColor }">
            {{
              selectedCategory ? selectedCategory + " Ara√ßlarƒ±" : "Son ƒ∞lanlar"
            }}
          </div>
          <div class="view-all-text" [ngStyle]="{ color: theme.accentColor }">
            T√ºm√ºn√º G√∂r
          </div>
        </div>

        <div *ngIf="filteredCars.length > 0; else noResults">
          <div
            *ngFor="let car of filteredCars"
            class="car-item"
            [ngStyle]="{
              'background-color': theme.cardColor,
              'box-shadow': '0px 1px 3px ' + theme.shadowColor + '3D'
            }"
            (click)="navigateToCarDetails(car)"
          >
            <img [src]="car.image" class="car-image" alt="Car Image" />
            <div
              class="favorite-button"
              (click)="$event.stopPropagation(); toggleFavorite(car)"
            >
              <span class="favorite-icon">{{
                isFavorite(car.id) ? "‚ù§Ô∏è" : "ü§ç"
              }}</span>
            </div>
            <div class="car-details">
              <div class="car-title" [ngStyle]="{ color: theme.textColor }">
                {{ car.year }} {{ car.make }} {{ car.model }}
              </div>
              <div class="car-price" [ngStyle]="{ color: theme.accentColor }">
                {{ car.price }}
              </div>
              <div class="car-info-row">
                <div
                  class="car-info"
                  [ngStyle]="{ color: theme.secondaryTextColor }"
                >
                  {{ car.mileage }}
                </div>
                <div
                  class="car-location"
                  [ngStyle]="{ color: theme.secondaryTextColor }"
                >
                  {{ car.location }}
                </div>
              </div>
            </div>
          </div>
        </div>

        <ng-template #noResults>
          <div class="no-results-container">
            <div class="no-results-text" [ngStyle]="{ color: theme.textColor }">
              Se√ßili kategoride ara√ß bulunamadƒ±.
            </div>
            <button
              class="clear-filter-button"
              [ngStyle]="{ 'background-color': theme.accentColor }"
              (click)="clearFilter()"
            >
              <span class="clear-filter-button-text" style="color: #fff"
                >Filtreyi Temizle</span
              >
            </button>
          </div>
        </ng-template>
      </div>
    </div>
  </div>
</div>
